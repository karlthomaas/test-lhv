<!DOCTYPE html>
<html lang="et" data-theme="light">

<head>
    <meta charset="UTF-8">
    <title>Soovinimekiri | LHV</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Koosta soovinimekiri ja vaata oma sisustuse kuumakset!">
    <link rel="icon" href="favicon.png">
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.2/dist/full.min.css" rel="stylesheet" type="text/css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- <script src="scripts/product.js" type="module"></script> -->
    <script>
        tailwind.config = {
            theme: {
                fontFamily: {
                    'sans': ['Helvetica Neue', 'Arial', 'sans-serif'],
                },
                extend: {
                    colors: {
                        neutral: "#89868D",
                        gray: {
                            600: "#6C6972",
                            900: "#262633"
                        },
                        text: "#262633",
                        border: "#C6C4C7"
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-white h-full w-full max-w-[942px] font-sans mx-auto">
    <div
        class="mt-10 mb-12 mx-4 h-full lg:w-[calc(100%-81px)] flex flex-col space-y-[31px] w-max lg:w-full lg:space-y-0 lg:mb-0 lg:mt-[214px] mx-auto">
        <h2 class="text-[28px] text-center font-light lg:hidden">Sisustuslaen</h2>
        <div class="relative size-[294px] lg:hidden hover:cursor-pointer">
            <img src="public/images/lounge.png" class="w-[100%]" alt="ruumi-pilt">
            <div class="absolute bottom-0 bg-[#8ECDD1] w-full h-[106px]">
                <h5 class="font-bold pl-[24px] pt-[20px] text-[18px] w-[240px] text-text">Kas sinu diivan on oma aja
                    ära elanud?
                </h5>
                <div class="absolute bottom-0 right-0 w-[51px] h-[51px]"
                    style="background: linear-gradient(to top left, #ffffff 50%, #3B3B47 50%);">
                    <img src="public/icons/left-arrow.svg" class="size-[15px] absolute top-2 left-2" alt="noole-ikoon">
                </div>
            </div>
        </div>
        <div class="hidden relative lg:block text-text lg:ml-auto">
            <div class="w-[861px] h-max py-[60px] pl-[294px] bg-[#8ECDD1] flex flex-col space-y-[13px]">
                <h5 class="font-bold text-[18px] h-[22px]">Kas sinu diivan on oma aja ära elanud?</h5>
                <p class="text-[16px] w-[486px] font-light tracking-wide">
                    Oled väsinud segadusest, kus asjadel pole oma kohta. Oled unistanud lausa täiesti uuest
                    sisekujundusest, aga kõik tundub korraga liiga kallis? LHV sisustuslaenuga saad oma unistused
                    ellu viia juba täna.
                </p>
                <a id="read-more" class="h-[24px] flex items-center hover:cursor-pointer">Loe lisa
                    <img src="public/icons/arrow-down.svg" class="inline-flex size-[16px] ml-2" alt="noole-ikoon">
                </a>
            </div>
            <img src="public/images/lounge.png" class="absolute top-[57px] -translate-x-[81px]" alt="ruumi-pilt">
        </div>
    </div>
    <div
        class="py-[40px] lg:py-[60px] w-full h- bg-[#F1EDEB] px-[24px] flex flex-col gap-[40px] justify-center rounded-[4px] text-text lg:mt-[123px] lg:px-[60px]">
        <p class="text-[28px] mx-auto lg:w-[456px] text-center font-bold">Koosta soovinimekiri <span
                class="font-light">ja vaata
                oma uue sisustuse kuumakset</span>
        </p>
        <div class="gap-[40px] flex flex-col lg:flex-row lg:justify-center lg:items-center lg:space-x-20">
            <table class="table-fixed border-separate [border-spacing:0.9rem] w-full text-neutral lg:w-[374px]">
                <thead>
                    <tr>
                        <th class="text-left font-medium text-gray-600 text-[12px]">TOODE</th>
                        <th class="text-left font-medium text-gray-600 text-[12px]">HIND</th>
                    </tr>
                </thead>
                <tbody id="products" class="">
                    <tr id="table-buttons" class="text-[14px]">
                        <td>
                            <button id="add-product" type="button"
                                class="btn btn-ghost mr-auto text-gray-600 font-medium px-1 -ml-1">
                                <img src="public/icons/circle_plus.svg" class="size-[20px]" alt="lisa-ikoon">
                                Lisa toode
                            </button>
                        </td>
                        <td class="flex justify-end">
                            <button id="delete-product" type="button"
                                class="btn btn-ghost text-gray-600 px-1 -mr-1 font-medium">
                                <img src="public/icons/trash.svg" class="size-[20px]" alt="prügi-ikoon">
                                Kustuta
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="flex flex-col items-center">
                <div class="text-3xl text-center font-thin text-[45px] mb-[24px] items-start">
                    <span id="total-price">0</span> €
                </div>
                <button type="button"
                    class="btn btn-neutral mb-[16px] font-medium text-white bg-[#3B3B47] rounded-[4px] w-full lg:w-max">
                    Taotle sisustuslaenu
                </button>
                <a
                    class="text-center underline underline-offset-4 font-light text-[14px] text-gray-600 hover:cursor-pointer">Tutvu
                    tingimustega</a>
            </div>
        </div>
    </div>
    <div
        class="mt-12 mb-[27px] ml-[27px] lg:py-12 lg:mx-0 lg:mb-0 mr-[28px] lg:mt-[60px] flex flex-col bg-white items-center text-xl text-text lg:flex-row lg:justify-between">
        <div class="flex flex-col space-y-6 items-center lg:flex-row lg:space-y-0 lg:space-x-7 lg:w-[456px] mb-6">
            <img src="public/icons/support.svg" class="w-[80px]" alt="abi-ikoon">
            <div class="flex flex-col lg:space-y-4">
                <h1 class="font-light">LHV <span class="font-semibold">Klienditugi</span></h1>
                <p class="hidden lg:block text-[16px] font-light">
                    Kui sul tekib pangateenuse kasutamisel probleeme, saad klienditoe infotelefonilt abi ööpäev ringi.
                </p>
            </div>
        </div>
        <div class="flex flex-col space-y-4 lg:flex-row lg:space-y-0 lg:justify-evenly lg:w-1/2 mb-12">
            <div class="flex space-x-4">
                <img src="public/icons/call.svg" class="size-[24px]" alt="telefoni-ikoon">
                <a href="tel:+3726800400" class="text-[22px] font-light">6 800 400</a>
            </div>
            <div class="flex space-x-4">
                <img src="public/icons/email.svg" class="size-[24px]" alt="email-ikoon">
                <h3 class="underline underline-offset-4 text-[22px] font-light hover:cursor-pointer">
                    info@lhv.ee
                </h3>
            </div>
        </div>

        <!-- Didn't find Helvetica Neue weight 400, so using 300 instead -->
        <p class="text-[16px] text-center font-light lg:hidden">
            Kui sul tekib pangateenuse kasutamisel probleeme, saad klienditoe infotelefonilt abi ööpäev ringi.
        </p>
    </div>
</body>

<script>
    /**
    * Represents a collection of products.
    */
    class Products {
        /**
            * Constructs a new instance of the Products class.
            */
        constructor() {
            this.products = {};
        }

        /**
            * Adds a new product to the collection.
            * @returns {number} The ID of the newly added product.
            */
        addProduct() {
            const id = Object.keys(this.products).length + 1;
            this.products[id] = { name: "", price: 0 };
            return id;
        }

        /**
            * Removes the last product from the collection.
            * @returns {number} The ID of the removed product.
            */
        removeProduct() {
            const lastKey = Object.keys(this.products).slice(-1);
            delete this.products[lastKey];
            return lastKey;
        }

        /**
            * Calculates the total price of all products in the collection.
            * @returns {number} The total price.
            */
        getTotalPrice() {
            return Object.values(this.products).reduce(
                (total, product) => total + (product.price || 0),
                0
            );
        }

        /**
            * Retrieves all products in the collection.
            * @returns {Object} The products.
            */
        getProducts() {
            return this.products;
        }

        /**
            * Edits a specific field of a product.
            * @param {number} id - The ID of the product.
            * @param {string} field - The field to edit.
            * @param {any} value - The new value for the field.
            */
        editProduct(id, field, value) {
            this.products[id][field] = value;
        }
    }

    const productsInstance = new Products();

    /**
        * Creates a new product field and adds it to the products list.
        * This function is called when a new product is added.
        */
    const createProductField = () => {
        const productId = productsInstance.addProduct();

        const tableButtons = document.getElementById("table-buttons");
        const productsList = document.getElementById("products");
        const productField = document.createElement("tr");
        const productHtml = createProductHtml();

        productField.id = productId;
        productField.innerHTML = productHtml;
        productsList.insertBefore(productField, tableButtons);

        // Focus on name input field
        const productNameInput = productField.getElementsByTagName("input")[0];
        productNameInput.focus();

        productField.addEventListener("input", (e) => {
            if (e.target.id === "product-name") {
                productsInstance.editProduct(productId, "name", e.target.value);
            } else if (e.target.id === "product-price") {
                if (!isNumeric(e.target.value)) {
                    e.target.value = null;
                }

                productsInstance.editProduct(
                    productId,
                    "price",
                    parseFloat(e.target.value.replace(/,/g, "."))
                );
                updateTotalPrice();
            }
        });
    };

    /**
        * Checks if a string is numeric.
        * @param {string} str - The string to check.
        * @returns {boolean} True if the string is numeric, false otherwise.
        */
    const isNumeric = (str) => {
        if (typeof str != "string") return false;
        // Remove commas before checking if it's numeric
        const noCommasStr = str.replace(/,/g, ".");
        return !isNaN(noCommasStr) && !isNaN(parseFloat(noCommasStr));
    };

    /**
        * Deletes a product from the DOM and updates the total price.
        */
    const deleteProduct = () => {
        const productId = productsInstance.removeProduct();
        const product = document.getElementById(productId);
        product.remove();

        // If there are no products left, create a new product field
        if (Object.keys(productsInstance.getProducts()).length === 0) {
            createProductField();
        }

        updateTotalPrice();
    };

    /**
        * Updates the total price on the page.
        */
    const updateTotalPrice = () => {
        const totalPrice = document.getElementById("total-price");
        totalPrice.innerText = productsInstance.getTotalPrice();
    };

    /**
        * Creates the HTML markup for a product.
        * @returns {string} The HTML markup for the product.
        */
    const createProductHtml = () => {
        return `
        <td class="w-1/2">
        <input id="product-name" type="text" placeholder="Toode" class="text-text text-[16px] w-full input input-ghost border-b-1 border-x-0 border-t-0 border rounded-none border-border pl-0" />
        </td>
        <td class="relative w-full overflow-hidden input input-ghost border-b-1 border-x-0 border-t-0 border rounded-none border-border flex items-center gap-2 pl-0">
            <input id="product-price" type="text" placeholder="Hind" class="grow text-text" />
            <span class="absolute right-0 text-lg text-neutral">
            €
            </span>
        </td>
`;
    };

    document.addEventListener("DOMContentLoaded", () => {
        createProductField();
        document
            .getElementById("add-product")
            .addEventListener("click", createProductField);
        document
            .getElementById("delete-product")
            .addEventListener("click", deleteProduct);
    });
</script>

</html>